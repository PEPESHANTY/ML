<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;'>ASS1&nbsp;</p>
<pre style='margin:0cm;font-size:13px;font-family:"Courier New";background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">pip install haversine</span></pre>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">import&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">pandas&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">as&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">pd<br>&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">import&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">numpy&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">as&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">np<br>&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">import&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">seaborn&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">as&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">sns<br>&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">import&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">matplotlib.pyplot&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">as&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">plt&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">import&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">haversine&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">as&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">hs&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">df&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">pd.read_csv(</span><span style="font-size:15px;font-family:Consolas;color:#B71E1E;">&apos;uber.csv&apos;</span><span style="font-size:15px;font-family:Consolas;color:black;">)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">df.head()&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">df.info()&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">df.drop([</span><span style="font-size:15px;font-family:Consolas;color:#B71E1E;">&apos;Unnamed: 0&apos;</span><span style="font-size:15px;font-family:Consolas;color:black;">,</span><span style="font-size:15px;font-family:Consolas;color:#B71E1E;">&apos;key&apos;</span><span style="font-size:15px;font-family:Consolas;color:black;">],axis&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:#008700;">1&nbsp;</span><span style="font-size:15px;font-family:Consolas;color:black;">,inplace&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">True</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">)</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">df.pickup_datetime&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">pd.to_datetime(df.pickup_datetime)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">df&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">df.assign(day&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">df.pickup_datetime.dt.day)<br>&nbsp;df&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">df.assign(month&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">df.pickup_datetime.dt.month)<br>&nbsp;df&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">df.assign(year&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">df.pickup_datetime.dt.year)<br>&nbsp;df&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">df.assign(dayofweek&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">df.pickup_datetime.dt.dayofweek) df&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">df.assign(hour&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">df.pickup_datetime.dt.hour)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">df.head()&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">df.drop(</span><span style="font-size:15px;font-family:Consolas;color:#B71E1E;">&apos;pickup_datetime&apos;</span><span style="font-size:15px;font-family:Consolas;color:black;">,axis&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=</span></strong><span style="font-size:15px;font-family:Consolas;color:#008700;">1&nbsp;</span><span style="font-size:15px;font-family:Consolas;color:black;">, inplace&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">True</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">df.isna().sum()</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'>&nbsp;</p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">df[</span><span style="font-size:15px;font-family:Consolas;color:#B71E1E;">&apos;dropoff_longitude&apos;</span><span style="font-size:15px;font-family:Consolas;color:black;">].fillna(value&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">df[</span><span style="font-size:15px;font-family:Consolas;color:#B71E1E;">&apos;dropoff_longitude&apos;</span><span style="font-size:15px;font-family:Consolas;color:black;">].mean(),inplace&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">True</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">) df[</span><span style="font-size:15px;font-family:Consolas;color:#B71E1E;">&apos;dropoff_latitude&apos;</span><span style="font-size:15px;font-family:Consolas;color:black;">].fillna(value&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">df[</span><span style="font-size:15px;font-family:Consolas;color:#B71E1E;">&apos;dropoff_latitude&apos;</span><span style="font-size:15px;font-family:Consolas;color:black;">].mean(),inplace&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">True</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">df.plot(kind&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:#B71E1E;">&apos;box&apos;</span><span style="font-size:15px;font-family:Consolas;color:black;">, subplots&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">True</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">, layout&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">(</span><span style="font-size:15px;font-family:Consolas;color:#008700;">7</span><span style="font-size:15px;font-family:Consolas;color:black;">,</span><span style="font-size:15px;font-family:Consolas;color:#008700;">2</span><span style="font-size:15px;font-family:Consolas;color:black;">), figsize&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">(</span><span style="font-size:15px;font-family:Consolas;color:#008700;">12</span><span style="font-size:15px;font-family:Consolas;color:black;">,</span><span style="font-size:15px;font-family:Consolas;color:#008700;">18</span><span style="font-size:15px;font-family:Consolas;color:black;">))</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'>&nbsp;<strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">def&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:blue;">remove_outliers</span><span style="font-size:15px;font-family:Consolas;color:black;">(df1,cols):&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;text-indent:36.0pt;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">Q1&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">df1[cols].quantile(</span><span style="font-size:15px;font-family:Consolas;color:#008700;">0.25</span><span style="font-size:15px;font-family:Consolas;color:black;">)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;text-indent:36.0pt;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">Q3&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">df1[cols].quantile(</span><span style="font-size:15px;font-family:Consolas;color:#008700;">0.75</span><span style="font-size:15px;font-family:Consolas;color:black;">)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;text-indent:36.0pt;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">IQR&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">Q3</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">-</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">Q1&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:36.0pt;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">lower_whisker&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">Q1&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">-&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:#008700;">1.5</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">*</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">IQR<br>&nbsp;upper_whisker&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">Q3&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">+&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:#008700;">1.5</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">*</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">IQR<br>&nbsp;df[cols]&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">np.clip(df1[cols],lower_whisker,upper_whisker)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:36.0pt;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">return&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">df1&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">def&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:blue;">treat_outliers</span><span style="font-size:15px;font-family:Consolas;color:black;">(df1,col_list):&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;text-indent:36.0pt;background:white;'><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">for&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">col&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">in&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">col_list:&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:36.0pt;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;text-indent:36.0pt;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">df1&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">remove_outliers(df1,col)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;text-indent:36.0pt;background:white;'><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">return&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">df1&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">df&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">treat_outliers(df,df.iloc[:,&nbsp;</span><span style="font-size:15px;font-family:Consolas;color:#008700;">0</span><span style="font-size:15px;font-family:Consolas;color:black;">::])&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;">&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">df.plot(kind&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:#B71E1E;">&apos;box&apos;</span><span style="font-size:15px;font-family:Consolas;color:black;">, subplots&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">True</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">,layout&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">(</span><span style="font-size:15px;font-family:Consolas;color:#008700;">7</span><span style="font-size:15px;font-family:Consolas;color:black;">,</span><span style="font-size:15px;font-family:Consolas;color:#008700;">2</span><span style="font-size:15px;font-family:Consolas;color:black;">), figsize&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">(</span><span style="font-size:15px;font-family:Consolas;color:#008700;">12</span><span style="font-size:15px;font-family:Consolas;color:black;">,</span><span style="font-size:15px;font-family:Consolas;color:#008700;">18</span><span style="font-size:15px;font-family:Consolas;color:black;">) )&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">dist_traveled&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">[]&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">for&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">pos&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">in&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">range&nbsp;</span><span style="font-size:15px;font-family:Consolas;color:black;">(</span><span style="font-size:15px;font-family:Consolas;color:#007F00;">len</span><span style="font-size:15px;font-family:Consolas;color:black;">(df[</span><span style="font-size:15px;font-family:Consolas;color:#B71E1E;">&apos;pickup_longitude&apos;</span><span style="font-size:15px;font-family:Consolas;color:black;">])):</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">&nbsp; &nbsp; picklongi , picklati, droplongi,droplati&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">[df[</span><span style="font-size:15px;font-family:Consolas;color:#B71E1E;">&apos;pickup_longitude&apos;</span><span style="font-size:15px;font-family:Consolas;color:black;">][pos],df[</span><span style="font-size:15px;font-family:Consolas;color:#B71E1E;">&apos;pickup_latitude&apos;] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [pos],df[&apos;dropoff_longitude&apos;][pos],df[&apos;dropoff_latitude&apos;][pos]</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:#B71E1E;">&nbsp; &nbsp;&nbsp;</span><span style="font-size:15px;font-family:Consolas;color:black;">location1&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">(picklati,picklongi)<br>&nbsp; &nbsp; location2&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">(droplati, droplongi)<br>&nbsp; &nbsp; dist&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">hs.haversine(location1,location2)<br>&nbsp; &nbsp; dist_traveled.append(dist)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">df[</span><span style="font-size:15px;font-family:Consolas;color:#B71E1E;">&apos;distance_traveled&apos;</span><span style="font-size:15px;font-family:Consolas;color:black;">]&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">dist_traveled&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">df.head()&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">corr_matrix&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">df.corr()&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">corr_matrix&nbsp;</span></p>
<pre style='margin:0cm;font-size:13px;font-family:"Courier New";background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">sns.heatmap(corr_matrix)</span></pre>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><br></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">y&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">df.pop(</span><span style="font-size:15px;font-family:Consolas;color:#B71E1E;">&apos;fare_amount&apos;</span><span style="font-size:15px;font-family:Consolas;color:black;">)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">x&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">df&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">from&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">sklearn.model_selection&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">import&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">train_test_split&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">x_train,x_test,y_train,y_test&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">train_test_split(x,y,test_size&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:#008700;">0.31</span><span style="font-size:15px;font-family:Consolas;color:black;">)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">from&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">sklearn.linear_model&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">import&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">LinearRegression&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">linearreg&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">LinearRegression()&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">linearreg.fit(x_train,y_train)&nbsp;</span></p>
<pre style='margin:0cm;font-size:13px;font-family:"Courier New";background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">linearreg.intercept_</span></pre>
<pre style='margin:0cm;font-size:13px;font-family:"Courier New";background:white;'><span style="font-size:15px;font-family:Consolas;">Â </span></pre>
<pre style='margin:0cm;font-size:13px;font-family:"Courier New";background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">linearreg.coef_</span></pre>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'>&nbsp;</p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">prediction&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">linearreg.predict(x_test)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:#007F00;">print</span><span style="font-size:15px;font-family:Consolas;color:black;">(prediction)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">from&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">sklearn.metrics&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">import&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">r2_score<br>&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">from&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">sklearn.metrics&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">import&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">mean_squared_error&nbsp;</span></p>
<pre style='margin:0cm;font-size:13px;font-family:"Courier New";background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">r2_score(y_test,prediction)</span></pre>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">MSE</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">mean_squared_error(y_test,prediction)<br>&nbsp;RMSE&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">np.sqrt(mean_squared_error(y_test,prediction))&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:#007F00;">print</span><span style="font-size:15px;font-family:Consolas;color:black;">(MSE , RMSE)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">from&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">sklearn.ensemble&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">import&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">RandomForestRegressor&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">rf&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">RandomForestRegressor(n_estimators&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:#008700;">70</span><span style="font-size:15px;font-family:Consolas;color:black;">)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">rf.fit(x_train,y_train )&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">predictions&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">rf.predict(x_test)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">predictions&nbsp;</span></p>
<pre style='margin:0cm;font-size:13px;font-family:"Courier New";background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">r2_score (y_test,predictions)</span></pre>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">MSE&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">mean_squared_error(y_test,predictions)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">RMSE&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">np.sqrt(MSE)</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:#007F00;">print</span><span style="font-size:15px;font-family:Consolas;color:black;">(MSE,RMSE)&nbsp;</span></p>
<div class="page" title="Page 8">
    <div class="section" style="background-color: rgb(100.000000%, 100.000000%, 100.000000%);"><br></div><br>ASS2
</div>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">import&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">pandas&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">as&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">pd<br>&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">import&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">numpy&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">as&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">np<br>&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">import&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">seaborn&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">as&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">sns<br>&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">import&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">matplotlib.pyplot&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">as&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">plt<br>&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">from&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">sklearn.model_selection&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">import&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">train_test_split</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">from&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">sklearn.svm&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">import&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">SVC&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">from&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">sklearn&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">import&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">metrics&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">df</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">pd.read_csv(</span><span style="font-size:15px;font-family:Consolas;color:#B71E1E;">&quot;emails.csv&quot;</span><span style="font-size:15px;font-family:Consolas;color:black;">)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">df.head()</span></p>
<pre style='margin:0cm;font-size:13px;font-family:"Courier New";background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">df.isna().sum()</span></pre>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">df.drop([</span><span style="font-size:15px;font-family:Consolas;color:#B71E1E;">&apos;Email No.&apos;</span><span style="font-size:15px;font-family:Consolas;color:black;">],axis&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:#008700;">1</span><span style="font-size:15px;font-family:Consolas;color:black;">,inplace&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">True</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">Y&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">df.pop(</span><span style="font-size:15px;font-family:Consolas;color:#B71E1E;">&apos;Prediction&apos;</span><span style="font-size:15px;font-family:Consolas;color:black;">)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">X&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">df&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">Y&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">from&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">sklearn.preprocessing&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">import&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">scale&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">X&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">scale(X)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">X_train, X_test, y_train, y_test&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">train_test_split(X, y, test_size&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:#008700;">0.3</span><span style="font-size:15px;font-family:Consolas;color:black;">, random_state&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:#008700;">4 )</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">from&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">sklearn.neighbors&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">import&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">KNeighborsClassifier&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">knn&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">KNeighborsClassifier(n_neighbors</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=</span></strong><span style="font-size:15px;font-family:Consolas;color:#008700;">7</span><span style="font-size:15px;font-family:Consolas;color:black;">)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">knn.fit(X_train, y_train)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">y_pred&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">knn.predict(X_test)&nbsp;</span></p>
<pre style='margin:0cm;font-size:13px;font-family:"Courier New";background:white;'><span style="font-size:15px;font-family:Consolas;color:#007F00;">print</span><span style="font-size:15px;font-family:Consolas;color:black;">(</span><span style="font-size:15px;font-family:Consolas;color:#B71E1E;">&quot;predictions&quot;</span><span style="font-size:15px;font-family:Consolas;color:black;">,y_pred)</span></pre>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">from&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">sklearn.metrics&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">import&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">accuracy_score&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">from&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">sklearn.metrics&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">import&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">confusion_matrix&nbsp;</span></p>
<pre style='margin:0cm;font-size:13px;font-family:"Courier New";background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">accuracy_score(y_test,y_pred)</span></pre>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">confusion_matrix(y_test,y_pred)</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><em><span style="font-size:15px;font-family:Consolas;color:#007777;"># cost C = 1&nbsp;</span></em></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">model&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">SVC(C&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:#008700;">1</span><span style="font-size:15px;font-family:Consolas;color:black;">)&nbsp;</span></p>
<pre style='margin:0cm;font-size:13px;font-family:"Courier New";background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">model.fit(X_train, y_train)</span></pre>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><em><span style="font-size:15px;font-family:Consolas;color:#007777;"># predict&nbsp;</span></em></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">y_pred&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">model.predict(X_test)&nbsp;</span></p>
<pre style='margin:0cm;font-size:13px;font-family:"Courier New";background:white;'><span style="font-size:15px;font-family:Consolas;color:#007F00;">print</span><span style="font-size:15px;font-family:Consolas;color:black;">(</span><span style="font-size:15px;font-family:Consolas;color:#B71E1E;">&quot;SVM accuracy = &quot;</span><span style="font-size:15px;font-family:Consolas;color:black;">,accuracy_score(y_test,y_pred))</span></pre>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">confusion_matrix(y_true</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">y_test, y_pred</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">y_pred)&nbsp;</span></p>
<p>&nbsp; &nbsp;&nbsp;</p>
<p>ASS3</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>&nbsp;</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>import pandas as pd</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>import numpy as np</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>import seaborn as sns</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>import matplotlib.pyplot as plt&nbsp;</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'><br></p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>df = pd.read_csv(&quot;Churn_Modelling.csv&quot;)</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'><br></p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>df.head()</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>&nbsp;</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>df.isnull().sum()</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>&nbsp;</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>df.drop([&quot;RowNumber&quot;,&quot;CustomerId&quot;,&quot;Surname&quot;],axis = 1, inplace = True)</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>&nbsp;</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>def visualization(x, y, xlabel):</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>&nbsp; &nbsp; plt.figure(figsize=(10,5))</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>&nbsp; &nbsp; plt.hist([x, y], color=[&apos;red&apos;, &apos;green&apos;], label = [&apos;exit&apos;, &apos;not_exit&apos;])</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>&nbsp; &nbsp; plt.xlabel(xlabel,fontsize=20)</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>&nbsp; &nbsp; plt.ylabel(&quot;No. of customers&quot;, fontsize=20)</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>&nbsp; &nbsp; plt.legend()</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>&nbsp;</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>df_churn_exited = df[df[&apos;Exited&apos;]==1][&apos;Tenure&apos;]</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>df_churn_not_exited = df[df[&apos;Exited&apos;]==0][&apos;Tenure&apos;]</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>visualization(df_churn_exited, df_churn_not_exited, &quot;Tenure&quot;)</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>&nbsp;</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>&nbsp;</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>df_churn_exited2 = df[df[&apos;Exited&apos;]==1][&apos;Age&apos;]</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>df_churn_not_exited2 = df[df[&apos;Exited&apos;]==0][&apos;Age&apos;]</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>visualization(df_churn_exited2, df_churn_not_exited2, &quot;Age&quot;)</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'><br></p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>X = df[[&apos;CreditScore&apos;,&apos;Gender&apos;,&apos;Age&apos;,&apos;Tenure&apos;,&apos;Balance&apos;,&apos;NumOfProducts&apos;,&apos;HasCrCard&apos;,&apos;IsActiveMember&apos;,&apos;EstimatedSalary&apos;]]</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>states = pd.get_dummies(df[&apos;Geography&apos;],drop_first = True)</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>gender = pd.get_dummies(df[&apos;Gender&apos;],drop_first = True)</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>&nbsp;</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>&nbsp;</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>df = pd.concat([df,gender,states], axis = 1)</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>X = df[[&apos;CreditScore&apos;,&apos;Age&apos;,&apos;Tenure&apos;,&apos;Balance&apos;,&apos;NumOfProducts&apos;,&apos;HasCrCard&apos;,&apos;IsActiveMember&apos;,&apos;EstimatedSalary&apos;,&apos;Male&apos;,&apos;Germany&apos;,&apos;Spain&apos;]]</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>y = df[&apos;Exited&apos;]</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>&nbsp;</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>from sklearn.model_selection import train_test_split</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>X_train,X_test,y_train,y_test = train_test_split(X,y,test_size = 0.30)</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>&nbsp;</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>&nbsp;from sklearn.preprocessing import StandardScaler</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>sc = StandardScaler()</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>X_train &nbsp;= sc.fit_transform(X_train)</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>X_test = sc.transform(X_test)</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>&nbsp;</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>X_train</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>&nbsp;</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>import keras&nbsp;</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>&nbsp;</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>from keras.models import Sequential&nbsp;</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>from keras.layers import Dense&nbsp;</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>classifier = Sequential()</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>&nbsp;</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>classifier.add(Dense(activation = &quot;relu&quot;,input_dim = 11,units = 6,kernel_initializer = &quot;uniform&quot;))&nbsp;</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>classifier.add(Dense(activation = &quot;relu&quot;,units = 6,kernel_initializer = &quot;uniform&quot;)) &nbsp; #Adding second hidden layers</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>classifier.add(Dense(activation = &quot;sigmoid&quot;,units = 1,kernel_initializer = &quot;uniform&quot;)) #Final neuron will be having siigmoid function</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>classifier.compile(optimizer=&quot;adam&quot;,loss = &apos;binary_crossentropy&apos;,metrics = [&apos;accuracy&apos;]) #To compile the Artificial Neural Network. Ussed Binary crossentropy as we just have only two output</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>&nbsp;</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>classifier.summary()&nbsp;</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>&nbsp;</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>classifier.fit(X_train,y_train,batch_size=10,epochs=50) #Fitting the ANN to training dataset</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>y_pred =classifier.predict(X_test)</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>y_pred = (y_pred &gt; 0.5) #Predicting the result</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>&nbsp;</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>from sklearn.metrics import confusion_matrix,accuracy_score,classification_report&nbsp;</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>cm = confusion_matrix(y_test,y_pred)</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>cm&nbsp;</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>accuracy = accuracy_score(y_test,y_pred)</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>accuracy</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>plt.figure(figsize = (10,7))</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>sns.heatmap(cm,annot = True)</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>plt.xlabel(&apos;Predicted&apos;)</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>plt.ylabel(&apos;Truth&apos;)</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>print(classification_report(y_test,y_pred))</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>&nbsp;</p>
<p style='margin:0cm;font-size:16px;font-family:"Times New Roman",serif;'>ASS4</p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">cur_x&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">=&nbsp;</span></strong><span style="font-size:13px;font-family:Courier;color:#008700;">2&nbsp;</span><em><span style="font-size:13px;font-family:Courier;color:#3F7F7F;"># The algorithm starts at x=3</span></em></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">rate&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">=&nbsp;</span></strong><span style="font-size:13px;font-family:Courier;color:#008700;">0.01&nbsp;</span><em><span style="font-size:13px;font-family:Courier;color:#3F7F7F;"># Learning rate - deafult value</span></em></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">precision&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">=&nbsp;</span></strong><span style="font-size:13px;font-family:Courier;color:#008700;">0.000001&nbsp;</span><em><span style="font-size:13px;font-family:Courier;color:#3F7F7F;"># This tells us when to stop the algorithm&nbsp;</span></em></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">previous_step_size&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">=&nbsp;</span></strong><span style="font-size:13px;font-family:Courier;color:#008700;">1&nbsp;</span><em><span style="font-size:13px;font-family:Courier;color:#3F7F7F;">#<br></span></em></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">max_iters&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">=&nbsp;</span></strong><span style="font-size:13px;font-family:Courier;color:#008700;">2000&nbsp;</span><em><span style="font-size:13px;font-family:Courier;color:#3F7F7F;"># maximum number of iterations</span></em></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">iters&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">=&nbsp;</span></strong><span style="font-size:13px;font-family:Courier;color:#008700;">0&nbsp;</span><em><span style="font-size:13px;font-family:Courier;color:#3F7F7F;">#iteration counter</span></em></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">df&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">=&nbsp;</span></strong><strong><span style="font-size:13px;font-family:Courier;color:#007F00;">lambda&nbsp;</span></strong><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">x</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">: (</span><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">x</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">+</span></strong><span style="font-size:13px;font-family:Courier;color:#008700;">3</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">)</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">**&nbsp;</span></strong><span style="font-size:13px;font-family:Courier;color:#008700;">2&nbsp;</span><em><span style="font-size:13px;font-family:Courier;color:#3F7F7F;">#Gradient of our function&nbsp;</span></em></p>
<pre style='margin:0cm;font-size:13px;font-family:"Courier New";background:white;'><em><span style="font-family:Courier;color:#3F7F7F;"># Import libraries</span></em></pre>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><strong><span style="font-size:13px;font-family:Courier;color:#007F00;">import&nbsp;</span></strong><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">matplotlib.pyplot&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#007F00;">as&nbsp;</span></strong><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">plt&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#007F00;">import&nbsp;</span></strong><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">numpy&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#007F00;">as&nbsp;</span></strong><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">np&nbsp;</span></p>
<pre style='margin:0cm;font-size:13px;font-family:"Courier New";background:white;'><em><span style="font-family:Courier;color:#3F7F7F;"># Creating vectors X and Y</span></em></pre>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">x&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">=&nbsp;</span></strong><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">np</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">.</span></strong><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">linspace</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">(</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">-</span></strong><span style="font-size:13px;font-family:Courier;color:#008700;">7</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">,&nbsp;</span><span style="font-size:13px;font-family:Courier;color:#008700;">2</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">,&nbsp;</span><span style="font-size:13px;font-family:Courier;color:#008700;">100</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">)&nbsp;</span><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">y&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">=&nbsp;</span></strong><span style="font-size:13px;font-family:Courier;color:#0054A8;">(</span><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">x</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">+</span></strong><span style="font-size:13px;font-family:Courier;color:#008700;">3</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">)&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">**&nbsp;</span></strong><span style="font-size:13px;font-family:Courier;color:#008700;">2&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">fig&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">=&nbsp;</span></strong><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">plt</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">.</span></strong><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">figure</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">(</span><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">figsize&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">=&nbsp;</span></strong><span style="font-size:13px;font-family:Courier;color:#0054A8;">(</span><span style="font-size:13px;font-family:Courier;color:#008700;">12</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">,&nbsp;</span><span style="font-size:13px;font-family:Courier;color:#008700;">7</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">))<br>&nbsp;</span><em><span style="font-size:13px;font-family:Courier;color:#3F7F7F;"># Create the plot<br>&nbsp;</span></em><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">plt</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">.</span></strong><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">plot</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">(</span><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">x</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">,&nbsp;</span><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">y</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">,&nbsp;</span><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">alpha&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">=&nbsp;</span></strong><span style="font-size:13px;font-family:Courier;color:#008700;">0.4</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">,&nbsp;</span><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">label&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">=</span></strong><span style="font-size:13px;font-family:Courier;color:#B71E1E;">&apos;Y = (X+3)2&apos;</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">,&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">color&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">=</span></strong><span style="font-size:13px;font-family:Courier;color:#B71E1E;">&apos;red&apos;</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">,&nbsp;</span><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">linestyle&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">=</span></strong><span style="font-size:13px;font-family:Courier;color:#B71E1E;">&apos;dashed&apos;</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">,&nbsp;</span><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">linewidth&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">=&nbsp;</span></strong><span style="font-size:13px;font-family:Courier;color:#008700;">2</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">,&nbsp;</span><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">marker&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">=</span></strong><span style="font-size:13px;font-family:Courier;color:#B71E1E;">&apos;D&apos;</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">,<br>&nbsp;</span><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">markersize&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">=&nbsp;</span></strong><span style="font-size:13px;font-family:Courier;color:#008700;">5</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">,&nbsp;</span><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">markerfacecolor&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">=</span></strong><span style="font-size:13px;font-family:Courier;color:#B71E1E;">&apos;blue&apos;</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">,&nbsp;</span><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">markeredgecolor&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">=</span></strong><span style="font-size:13px;font-family:Courier;color:#B71E1E;">&apos;blue&apos;</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><em><span style="font-size:13px;font-family:Courier;color:#3F7F7F;"># Add a title&nbsp;</span></em></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">plt</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">.</span></strong><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">title</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">(</span><span style="font-size:13px;font-family:Courier;color:#B71E1E;">&apos;Given function plot&apos;</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">)&nbsp;</span></p>
<pre style='margin:0cm;font-size:13px;font-family:"Courier New";background:white;'><em><span style="font-family:Courier;color:#3F7F7F;"># Add X and y Label</span></em></pre>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">plt</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">.</span></strong><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">xlabel</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">(</span><span style="font-size:13px;font-family:Courier;color:#B71E1E;">&apos;x axis&apos;</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">)&nbsp;</span><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">plt</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">.</span></strong><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">ylabel</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">(</span><span style="font-size:13px;font-family:Courier;color:#B71E1E;">&apos;y axis&apos;</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><em><span style="font-size:13px;font-family:Courier;color:#3F7F7F;"># Add a grid&nbsp;</span></em></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">plt</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">.</span></strong><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">grid</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">(</span><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">alpha&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">=</span></strong><span style="font-size:13px;font-family:Courier;color:#008700;">.6</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">,&nbsp;</span><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">linestyle&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">=</span></strong><span style="font-size:13px;font-family:Courier;color:#B71E1E;">&apos;--&apos;</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">)&nbsp;</span><em><span style="font-size:13px;font-family:Courier;color:#3F7F7F;"># Add a Legend&nbsp;</span></em></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">plt</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">.</span></strong><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">legend</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">()&nbsp;</span></p>
<pre style='margin:0cm;font-size:13px;font-family:"Courier New";background:white;'><em><span style="font-family:Courier;color:#3F7F7F;"># Show the plot</span></em></pre>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">plt</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">.</span></strong><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">show</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">()&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><strong><span style="font-size:13px;font-family:Courier;color:#007F00;">while&nbsp;</span></strong><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">previous_step_size&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">&gt;&nbsp;</span></strong><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">precision&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">and&nbsp;</span></strong><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">iters&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">&lt;&nbsp;</span></strong><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">max_iters</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">:&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;text-indent:36.0pt;background:white;'><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">prev_x&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">=&nbsp;</span></strong><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">cur_x&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;text-indent:36.0pt;background:white;'><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">cur_x&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">-=&nbsp;</span></strong><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">rate&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">*&nbsp;</span></strong><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">df</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">(</span><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">prev_x</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;text-indent:36.0pt;background:white;'><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">previous_step_size&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">=&nbsp;</span></strong><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">abs</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">(</span><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">prev_x&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">-&nbsp;</span></strong><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">cur_x</span><span style="font-size:13px;font-family:Courier;color:#0054A8;">)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;text-indent:36.0pt;background:white;'><span style="font-size:13px;font-family:Courier;color:#1E1E1E;">iters&nbsp;</span><strong><span style="font-size:13px;font-family:Courier;color:#A821FF;">+=&nbsp;</span></strong><span style="font-size:13px;font-family:Courier;color:#008700;">1&nbsp;</span></p>
<pre style='margin:0cm;font-size:13px;font-family:"Courier New";background:white;'><span style="font-family:Courier;color:#1E1E1E;">print</span><span style="font-family:Courier;color:#0054A8;">(</span><span style="font-family:Courier;color:#B71E1E;">&quot;Local Minima Occurs at :&quot;</span><span style="font-family:Courier;color:#0054A8;">,</span><span style="font-family:Courier;color:#1E1E1E;">cur_x</span><span style="font-family:Courier;color:#0054A8;">)</span></pre>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;'>&nbsp;</p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;'><br></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;'>ASS5</p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;'><br></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">import&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">pandas&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">as&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">pd</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">import&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">numpy&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">as&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">np</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">import&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">seaborn&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">as&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">sns</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">import&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">matplotlib.pyplot&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">as&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">plt&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">df&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">pd.read_csv(</span><span style="font-size:15px;font-family:Consolas;color:#B71E1E;">&apos;diabetes.csv&apos;</span><span style="font-size:15px;font-family:Consolas;color:black;">)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">df.head()&nbsp;</span></p>
<pre style='margin:0cm;font-size:13px;font-family:"Courier New";background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">df.isnull().sum()</span></pre>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">y&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">df.pop(</span><span style="font-size:15px;font-family:Consolas;color:#B71E1E;">&quot;Outcome&quot;</span><span style="font-size:15px;font-family:Consolas;color:black;">)</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">x&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">df&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">from&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">sklearn.preprocessing&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">import&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">scale&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">x&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">scale(x)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">from&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">sklearn.model_selection&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">import&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">train_test_split x_train,x_test,y_train,y_test&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">train_test_split(x,y,test_size&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:#008700;">0.33</span><span style="font-size:15px;font-family:Consolas;color:black;">)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">from&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">sklearn.neighbors&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#007F00;">import&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">KNeighborsClassifier&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">knn&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">KNeighborsClassifier(n_neighbors&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:#008700;">7</span><span style="font-size:15px;font-family:Consolas;color:black;">)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">knn.fit(x_train,y_train)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">y_predict&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">knn.predict(x_test)&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">y_predict&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">acc&nbsp;</span><strong><span style="font-size:15px;font-family:Consolas;color:#7014AA;">=&nbsp;</span></strong><span style="font-size:15px;font-family:Consolas;color:black;">accuracy_score(y_test,y_predict)</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">acc</span></p>
<pre style='margin:0cm;font-size:13px;font-family:"Courier New";background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">confusion_matrix(y_test,y_predict)</span></pre>
<pre style='margin:0cm;font-size:13px;font-family:"Courier New";background:white;'><span style="font-size:15px;font-family:Consolas;">Â </span></pre>
<pre style='margin:0cm;font-size:13px;font-family:"Courier New";background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">precision_score(y_test,y_predict)</span></pre>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'>&nbsp;</p>
<pre style='margin:0cm;font-size:13px;font-family:"Courier New";background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">recall_score (y_test,y_predict)</span></pre>
<p style='margin-right:0cm;margin-left:0cm;font-size:16px;font-family:"Times New Roman",serif;margin:0cm;background:white;'>&nbsp;</p>
<pre style='margin:0cm;font-size:13px;font-family:"Courier New";background:white;'><span style="font-size:15px;font-family:Consolas;color:black;">classification_report(y_test,y_predict)</span></pre>